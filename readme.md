This is a Google Code Jam Problem from 2013
https://code.google.com/codejam/contest/2270488/dashboard#s=p2
